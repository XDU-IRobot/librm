"use strict";(self.webpackChunklibrm_docs=self.webpackChunklibrm_docs||[]).push([[183],{5918:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"tutorials/rgb-led","title":"RGB LED \u63a7\u5236\u5668","description":"\u672c\u4f8b\u7a0b\u6f14\u793a\u5982\u4f55\u4f7f\u7528 librm \u4e2d\u7684 RgbLedController \u7c7b\u63a7\u5236 RGB LED \u7684\u5404\u79cd\u706f\u6548\u3002","source":"@site/docs/tutorials/rgb-led.mdx","sourceDirName":"tutorials","slug":"/tutorials/rgb-led","permalink":"/tutorials/rgb-led","draft":false,"unlisted":false,"editUrl":"https://github.com/XDU-IRobot/librm/tree/main/docs/docs/tutorials/rgb-led.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u88c1\u5224\u7cfb\u7edf\u4e32\u53e3","permalink":"/tutorials/referee"},"next":{"title":"\u5e8f\u5217\u64ad\u653e\u5668","permalink":"/tutorials/sequence-player"}}');var l=r(4848),s=r(8453);const o={},i="RGB LED \u63a7\u5236\u5668",d={},c=[{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:2}];function a(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"rgb-led-\u63a7\u5236\u5668",children:"RGB LED \u63a7\u5236\u5668"})}),"\n",(0,l.jsxs)(n.p,{children:["\u672c\u4f8b\u7a0b\u6f14\u793a\u5982\u4f55\u4f7f\u7528 librm \u4e2d\u7684 ",(0,l.jsx)(n.code,{children:"RgbLedController"})," \u7c7b\u63a7\u5236 RGB LED \u7684\u5404\u79cd\u706f\u6548\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"RgbLedController"})," \u57fa\u4e8e ",(0,l.jsx)(n.code,{children:"SequencePlayer"})," \u5b9e\u73b0\uff0c\u63d0\u4f9b\u4e86\u591a\u79cd\u9884\u5b9a\u4e49\u706f\u6548\uff08\u547c\u5438\u706f\u3001\u95ea\u70c1\u3001\u6d41\u52a8\u7b49\uff09\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u706f\u6548\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:'#include "tim.h"\n#include "cmsis_os.h"\n\n#include <librm.hpp>\n\n// \u81ea\u5b9a\u4e49\u706f\u6548\uff1a\u7d2b\u8272\u95ea\u70c1\nclass PurpleFlash : public rm::modules::RgbLedPattern {\n  TimePoint start_time_;\n\n public:\n  Rgb Update(TimePoint now) override {\n    auto elapsed = ElapsedMs(start_time_, now);\n    // \u6bcf500ms\u5207\u6362\u4e00\u6b21\n    if ((elapsed / 500) % 2 == 0) {\n      return Rgb(128, 0, 128);  // \u7d2b\u8272\n    }\n    return Rgb(0, 0, 0);  // \u7184\u706d\n  }\n\n  void Reset(TimePoint now) override {\n    start_time_ = now;\n  }\n};\n\nextern "C" void RgbLedTask(const void *pv_arg) {\n  // \u521b\u5efa RGB LED \u63a7\u5236\u5668\uff0c\u5305\u542b\u591a\u79cd\u706f\u6548\n  rm::modules::RgbLedController<\n      rm::modules::led_pattern::Off,\n      rm::modules::led_pattern::GreenBreath,\n      rm::modules::led_pattern::RedFlash,\n      rm::modules::led_pattern::RgbFlow,\n      PurpleFlash\n  > led_controller;\n\n  // \u542f\u52a8\u65f6\u64ad\u653e\u7eff\u8272\u547c\u5438\u706f\n  led_controller.SetPattern<rm::modules::led_pattern::GreenBreath>();\n\n  for (;;) {\n    // \u66f4\u65b0\u706f\u6548\u5e76\u83b7\u53d6\u5f53\u524d\u989c\u8272\n    auto [r, g, b] = led_controller.Update();\n\n    // \u8bbe\u7f6e PWM \u8f93\u51fa\uff08\u5047\u8bbe\u4f7f\u7528 TIM3 \u7684\u4e09\u4e2a\u901a\u9053\uff09\n    __HAL_TIM_SET_COMPARE(&htim3, TIM_CHANNEL_1, r);\n    __HAL_TIM_SET_COMPARE(&htim3, TIM_CHANNEL_2, g);\n    __HAL_TIM_SET_COMPARE(&htim3, TIM_CHANNEL_3, b);\n\n    osDelay(10);  // 100Hz \u66f4\u65b0\u9891\u7387\n  }\n}\n'})}),"\n",(0,l.jsxs)(n.admonition,{type:"tip",children:[(0,l.jsx)(n.p,{children:"\u9884\u5b9a\u4e49\u706f\u6548\u5305\u62ec\uff1a"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Off"})," - \u5173\u95ed"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GreenBreath"})," - \u7eff\u8272\u547c\u5438\u706f\uff081700ms \u5468\u671f\uff09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"RedFlash"})," - \u7ea2\u706f\u95ea\u70c1\uff081000ms \u5468\u671f\uff09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"RgbFlow"})," - RGB \u6d41\u52a8\uff081536ms \u5468\u671f\uff09"]}),"\n"]})]}),"\n",(0,l.jsx)(n.admonition,{type:"info",children:(0,l.jsxs)(n.p,{children:["\u53ef\u4ee5\u901a\u8fc7\u7ee7\u627f ",(0,l.jsx)(n.code,{children:"RgbLedPattern"})," \u7c7b\u5b9e\u73b0\u81ea\u5b9a\u4e49\u706f\u6548\uff0c\u53ea\u9700\u5b9e\u73b0 ",(0,l.jsx)(n.code,{children:"Update()"})," \u548c ",(0,l.jsx)(n.code,{children:"Reset()"})," \u65b9\u6cd5\u5373\u53ef\u3002"]})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var t=r(6540);const l={},s=t.createContext(l);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);